/*2018/04/21 12:23:45*/function UseMobile(){for(var t=["midp","j2me","avant","docomo","novarra","palmos","palmsource","240x320","opwv","chtml","pda","windows ce","mmp/","blackberry","mib/","symbian","wireless","nokia","hand","mobi","phone","cdm","up.b","audio","sie-","sec-","samsung","htc","mot-","mitsu","sagem","sony","alcatel","lg","eric","vx","NEC","philips","mmm","xx","panasonic","sharp","wap","sch","rover","pocket","benq","java","pt","pg","vox","amoi","bird","compal","kg","voda","sany","kdd","dbt","sendo","sgh","gradi","jb","dddi","moto","iphone","android","iPod","incognito","webmate","dream","cupcake","webos","s8000","bada","googlebot-mobile"],i=navigator.userAgent.toLowerCase(),n=0;n<t.length;n++)if(i.indexOf(t[n])>0)return!0;return!1}function CheckNoHtml(n){return!/<([a-z]+) *[^\/]*?>/.test(n)}function NewWindow_epaper(){thewindow=window.open("/Other/ePaper","thewindow","left=150,top=200,width=460,height=310");thewindow.opener==null&&(thewindow.opener=window)}function NewWindow_spoof(){thewindow=window.open("/StaticPage/spoof.html","thewindow","top=50,width=850,height=800");thewindow.opener==null&&(thewindow.opener=window)}function searchcheck(){var n=$("#qu").val(),t=$("#ct option:selected").val(),r="",u;if(t==undefined&&(t="K"),n.length==0?(n=$("#qu").attr("placeholder"),$("#qu").val(n)):n.length>0?(n=n.replace(/[\!|\~|\`|\&|\!|\@@|\$|\%|\^|\&|\*|\(|\)|\_|\=|\||\\|\[|\]|\{|\}|\;|\:|\,|\<|\.|\>|\/]/g," "),n=n.replace(/  /g," ").replace(/  /g," ").replace(/ /g," "),n=n.replace(" AND "," and ").replace(" OR "," or "),$("#qu").val(n)):r="請輸入至少一個字以上來查詢。",r==""){var f=t,i="";["TC","S","HK","P","R","D","R","L"].indexOf(t)>=0?(i="&fq=ProdType:"+t,t="K"):t=="NP"?(t="K",i="&fq=ProdType:N"):t=="Bonus"&&(t="K",i="&fq=BonusRebatePoint:[1%20TO%20*]");u=/^([\d]{9})(x{1}|X{1}|[\s]{0}|[\d]{1}|[\d]{3,4})$/;u.test(n)&&(t="ISBN");location.href="/search/index/?ct="+t+"&qu="+encodeURIComponent(n)+"&ls=SD"+i}else return alert(r),!1;return!1}function GoTop(){$("html,body").stop().animate({scrollTop:0},500)}function Go(n){Loading("show");GoTop();setTimeout(function(){location.href=n},500)}function GoTo(n){Go(n)}function GO(n){Go(n)}function GoHome(){location.href="/home/index/"}function Move(n){$("html,body").stop().animate({scrollTop:n},500)}function Login(){Loading("show");setTimeout(function(){location.href="/Member/Login/?returnurl="+location.href.replace(/&/g,"%26")},500)}function Logout(){Loading("show");setTimeout(function(){location.href="/Member/Logout/?returnurl="+location.href.replace(/&/g,"%26")},500)}function LoginPanel(n){if(n==="True"){var t=$(".LoginMenu").find(".btnLogin");t.addClass("btnLogout").removeClass("btnLogin").text("會員登出").attr("onclick","Logout();")}}function open_window(n){aWindow=window.open(n,"aWindow","Toolbar=no,width=982,height=460,status=no,scrollbars=yes, resize=no,menubar=no")}function AddItem(n,t,i){var r,u,o,f;Loading("show");$("#DivAddItem").length==0&&$("<div/>").attr("id","DivAddItem").appendTo("body");var s=$("#DivAddItem"),h=$("<div/>").attr("style","disply:none;"),e="";return t==!0&&(e="&quickMode=True"),r="",i&&(r="&sFlag="+i),u="https://"+location.host,location.host==="localhost"&&(u="https://localhost:44300"),o=u+"/Shopping/AddItem/?id="+n+"&js=true"+e+r,$(".AddScript").remove(),f=$("<script/>").addClass(".AddScript"),f.attr("src",o),f.appendTo("body"),!0}function AddItemOK(n){Loading("hide");MsgBox(n)}function ReloadCaptchaImg(){var n=Math.floor(Math.random()*100);$("#CaptchaImg").attr("src","/other/Captcha/"+n)}function LoadOrderInfo(){AjaxJsView("OrderInfo","OrderInfoBox")}function JsonLoad(n,t){var i=$("#"+n);$.getJSON(t).done(function(n){i.html(n.value)})}function AjaxJsView(n,t){var i=$("<script/>").attr("type","text/javascript");i.attr("src","/API/AjaxJsView/"+n+"/"+t);i.appendTo("body")}function GetBrowser(){var u=navigator.userAgent.toLowerCase(),n="other",i=["msie 5.0","msie 6.0","msie 7.0","msie 8.0","msie 9.0","msie 10.0","like gecko","firefox","safari","opera","netscape","chrome"],r,t;for(r in i)t=i[r],u.indexOf(t)!=-1&&(n=t),n=="like gecko"&&(n="IE11"),n=n.replace(/ /g,"").replace("msie","IE");return n}function Lazyload(){var n=$(".lazyload,div.SanminProdImg img,img.SanminProdImg,img.SanminProdImg2");if(n.length>0){var t=$(window).scrollTop(),i=self.innerHeight,r=t+i;n.each(function(){var n=$(this),t=n.attr("original");ShowProdImg(n)})}}function ShowProdImg(n){var t=n.attr("original");n.removeClass("lazyload").removeAttr("original");n.attr("src",t)}function SelectAll(){$(".Ck_add").each(function(){this.checked=!0})}function SelectClear(){$(".Ck_add").each(function(){this.checked=!1})}function SelectToAdd(){var n="";$('input:checkbox:checked[class="Ck_add"]').each(function(){n+="+"+$(this).val()});n.length>1&&AddItem(n.substring(0),!1)}function sleep(n){for(var t=new Date,i=t.getTime()+n;;)if(t=new Date,t.getTime()>i)return}function WindowsCenter(n){var t=$("."+n),i=$(window).height()/2-t.height()/2,r=$(window).width()/2-t.width()/2;i<0&&(i=400);t.css("left",r).css("top",10).css("opacity",0);t.stop().animate({top:i,opacity:1},200)}function getCookie(n){for(var r=n+"=",u=document.cookie.split(";"),t,i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return""}function setCookie(n,t,i){var r=new Date,u;r.setTime(r.getTime()+i*864e5);u="expires="+r.toUTCString();document.cookie=n+"="+t+"; "+u}function Loading(n){var i=$("#Body"),e=i.offset(),u=e.top,f=i.height(),t,r;n==="show"?(t=$("<div/>").addClass("LoadingBk"),r=$("<div/>").addClass("LoadingImg"),r.html("<p>載入中請稍候<\/p>"),$("#ReOrderLoad").length===1?t.css("top",u).height(f):t.css("top",u).height(f),t.appendTo("body"),r.appendTo("body")):($(".LoadingBk").remove(),$(".LoadingImg").remove(),i.show())}function MVCAlert(n){var t=$("<div/>").load("/other/alert/?id="+encodeURIComponent(n));t.appendTo("body")}function MsgBox(n,t,i){var f=UseMobile(),r,u;t===undefined&&(t="");i===undefined&&(i=400);f===!1?(n=n.replace("\n","<br/>"),r=$("<div/>"),u=$("<div/>"),u.addClass("MsgBoxForm").html('<div class="MsgStr"><b>'+n+'<\/b><\/div><div style="text-align:center;"><button class="OK">確定<\/button><\/div>').width(i).appendTo(r),r.addClass("MsgBox BlackBG").appendTo("body").show(),WindowsCenter("MsgBoxForm"),u.find(".OK").click(function(){t.length>0&&(location.href=t);r.remove()}).focus(),r.click(function(){u.find(".OK").click()})):(n=n.replace("<br/>","\n"),alert(n),t.length>0&&(location.href=t))}function AjaxForm(n,t,i){function u(r){var u=$("#"+r);u.find(".modal-title").html(n);i!=undefined&&u.find(".modal-dialog").width(i);n==="系統提示"?(u.find(".modal-body").html(t),u.modal("show"),setTimeout(function(){Loading("hide")},500)):$.ajax({type:"GET",url:t,data:{ajax:"true"},cache:!1}).done(function(n){u.find(".modal-body").html(n);u.modal("show");setTimeout(function(){Loading("hide")},500)}).fail(function(){alert("error");setTimeout(function(){Loading("hide")},500)})}var r="AjaxForm";Loading("show");setTimeout(function(){$("#"+r).length===0?$.ajax({type:"GET",url:"/other/viewhelper/modal/"+r,cache:!1}).done(function(n){var t=$("<div/>");t.appendTo("body").replaceWith(n);u(r)}).fail(function(){alert("error")}):u(r)},500)}function AjaxLink(n){var t,i;if(n.length>0){if(n.indexOf("java")>=0||n==="#")return!0;Loading("show");$("html,body").animate({scrollTop:0},500);$(window).scrollTop(0);t={href:n};n.substring(0,1)=="/"&&MyBrowser.substring(0,2)!="IE"&!1?$.ajax({type:"POST",url:n,data:{nolayout:!0},cache:!1}).done(function(n){$("Body").html(n);Loading("hide")}).fail(function(){alert("error")}):location.href=n}else i=GetBrowser(),$("#Loading").show();return!1}function Get_Company_Name(n,t){var i=$("#"+n).val(),r;/^([\d]{8})$/.test(i)?($("#"+t).val(""),r="/API/Company/"+i,Loading("show"),$.ajax({type:"get",url:r,dataType:"json",success:function(n){$("#"+t).val(n[0].Company_Name);Loading("hide")},error:function(){alert("查不到此統一編號的相關資訊，請自行輸入抬頭。");Loading("hide")}})):alert("您的統一編號格式非8碼數字。")}var nuderIE8,Nowurl;location.href.indexOf("www.m.sanmin.com.tw")>0&&(location.href=location.href.replace("www.m.sanmin.com.tw","m.sanmin.com.tw"));var support=$.support,specialEffect=support.style,userAgent=navigator.userAgent.toLowerCase(),MyBrowser=GetBrowser();jQuery.browser={version:(userAgent.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(userAgent),opera:/opera/.test(userAgent),msie:/msie/.test(userAgent)&&!/opera/.test(userAgent),mozilla:/mozilla/.test(userAgent)&&!/(compatible|webkit)/.test(userAgent)};nuderIE8=!1;v=$.browser.version;$.browser.msie==!0&&(v=="7.0"||v=="6.0")&&(nuderIE8=!0),function(){jQuery.fn.setfocus=function(){return this.each(function(){var n=this;setTimeout(function(){try{n.focus()}catch(t){}},0)})}}(jQuery);$(function(){function ft(){StartSearchFlag=!1;setTimeout(et,500)}function et(){var n,r,u;StartSearchFlag||(n=i.val(),r=i.offset(),n=n.trim(),rephonetic=/[\u3105-\u3129\u02CA\u02C7\u02CB\u02D9]/,n.length>=1&&n.length<=10?(t.css("top",r.top+25).css("left",r.left).css("min-width",i.width()+2).css("z-index",999),u=rephonetic.exec(n.substr(-1,1))==null,u&&(t.toggle(!1),tmpWord!=n&&($TipWord.find("li").remove(),$.getJSON("/Search/keyWord/"+encodeURIComponent(n),function(r){$.each(r,function(t,r){$li=$("<li/>").html(r);$li.click(function(){tmpWord=n;i.val($(this).text());w()});$li.appendTo($TipWord)});$TipWord.find("li").length>0&&t.delay(100).toggle(!0)}),StartSearchFlag=!1,tmpWord=n),$TipWord.find("li").length>0&&t.delay(100).toggle(!0))):w())}function w(){$TipWord.find("li").remove();t.toggle(!1)}function it(t){var u=l.eq(t),i,r;e=t;i=n.find("li").eq(t).find("img");r=i.attr("original");typeof orininal!==undefined&&i.attr("src",r).removeAttr("orininal");b.find(".ICON-ball_Red").removeClass("ICON-ball_Red").addClass("ICON-ball_Gray");u.removeClass("ICON-ball_Gray").addClass("ICON-ball_Red");t-a>=2?n.css("margin-left",(-t+1)*585):a-t>=2&&n.css("margin-left",(-t-1)*585);n.stop().animate({"margin-left":-t*585},300);a=t}function v(){e+1>=tt?e=0:e+=1;it(e);r=setTimeout(v,h)}function ot(){f||$(".ShoppingMenu_child").hide()}var i,t,g,l,a,o,y,u,k,rt,p,s,d,f;Lazyload();MyBrowser.substring(0,2)!="IE"&&$("a").click(function(n){var r=n.button,i,t;if(r==0&&(i=$(this).attr("target"),t=$(this).attr("href"),$(".popover").remove(),(typeof i==typeof undefined||i==!1)&&typeof t!=typeof undefined&&t.indexOf("#")<=0))return AjaxLink(t)});i=$("#qu");t=$(".SearchTip");$TipWord=t.find(".TipWord");tmpWord="";speed_SETIP=200;StartSearchFlag=!1;i.focusin(function(){}).focusout(function(){setTimeout(w,500)}).keyup(function(){StartSearchFlag=!0;setTimeout(ft,500)});g=20;$(".PromoProd").each(function(){var i=$(this).height(),u=$(this).find(".ProdInfo").height(),n=$(this).find(".Intro").text(),r=$(this).find(".Title>a").attr("href"),t;n=n.replace(/ /g,"");n.length>10&&(t=$("<div/>").addClass("ICON").addClass("ICON-more").addClass("BtnMore").attr("onclick","GO('"+r+"')"),t.css("top",i-g).appendTo($(this)))});var nt=$(".Menu585"),n=nt.find(".Promo_list>ul"),tt=n.find("li").length,b=nt.find(".btn_number>ul"),r,h=3e3,e=0;if(n.find("li").each(function(){$("<li/>").addClass("ICON-ball_Gray").addClass("ICON").appendTo(b)}),n.width(tt*585),l=b.find("li"),l.eq(0).addClass("ICON-ball_Red").removeClass("ICON-ball_Gray"),l.hover(function(){it($(this).index());clearTimeout(r)},function(){r=setTimeout(v,h)}).click(function(){window.open(n.find("a").eq($(this).index()).attr("href"))}),n.hover(function(){clearTimeout(r)},function(){r=setTimeout(v,h)}),r=setTimeout(v,h),a=0,o=$(".HeadImg"),y=o.length,o.eq(0).show(),y>1){u=1;k=5e3;function ut(){o.hide();o.eq(u).show();u=u+1;u>=y&&(u=0);rt=setTimeout(ut,k)}y>1&&(rt=setTimeout(ut,k))}$(window).resize(function(){_windowHieight=$(window).height();$(window).width()<1745?$(".specbox").css("height",30):$(".specbox").css("height",0)}).resize();$('a[href^="/Shopping/AddItem/"]').each(function(){var t=$(this),n=t.attr("href");n.indexOf("/Shopping/AddItem/")==0&&(n=n.replace("/Shopping/AddItem/",""),c="",$(this).attr("class")&&(c=$(this).attr("class")),n=c.indexOf("quick")>=0?"javascript:AddItem('"+n+"',true);":"javascript:AddItem('"+n+"',false);",t.attr("href",n),t.addClass("AddItem"))});$('a[href*="javascript:AddItem"]').each(function(){var n=$(this).attr("href");$(this).attr("href",n.replace(/&#39;/g,'"'))});$(".modal").appendTo("body");location.hostname!="localhost"&&(p=p||[],p.push(["_setAccount","UA-36215709-1"]),p.push(["_trackPageview"]),s=document.createElement("script"),s.type="text/javascript",s.async=!0,s.src=("https:"==document.location.protocol?"https://":"http://")+"stats.g.doubleclick.net/dc.js",d=document.getElementsByTagName("script")[0],d.parentNode.insertBefore(s,d));$(".ClassMenu").each(function(){var t=$(this),f=t.find("li"),i=t.find("span"),r=t.attr("value"),n,u;i.length>0&&(n=i.eq(0).attr("name"),typeof n!="undefined"&&n!==!1&&(u=n.length,i.click(function(){var n=$(this).attr("name");AjaxLink(r+n)})))});f=!1;$("#ShoppingMenu").find("li").mouseenter(function(){var n;if(f=!1,$(".ShoppingMenu_child").hide(),$("#ShoppingMenu").find("li").removeClass("active"),n="."+$(this).attr("class"),$(n).length>0){f=!0;var t=$(this).offset(),i=t.left,r=t.top;$(n).css("left",i).css("top",r+40).show();$(this).addClass("active")}});$(".ShoppingMenu").mouseleave(function(){f=!1;setTimeout(function(){ot()},100)});$(".ShoppingMenu_child").mouseenter(function(){f=!0}).mouseleave(function(){$(this).hide();$("#ShoppingMenu").find("li").removeClass("active")});$(".ShoppingMenu_child").find("li").click(function(){$(".ShoppingMenu_child").hide()});$(".ShoppingMenu_child").find("li").click(function(){$(".ShoppingMenu_child").hide();var n=$(this).find("a").attr("href");Loading("show");location.href=n});$(".PageBtnPanel li").click(function(){location.href=$(".PageLink").attr("url")+"&pi="+$(this).attr("value")});$(".ViewStyleBtn > .ViewBtn").click(function(){location.href=$("#ViewStyleUrl").val()+"&vs="+$(this).attr("value")})});Nowurl=location.href.toLowerCase()